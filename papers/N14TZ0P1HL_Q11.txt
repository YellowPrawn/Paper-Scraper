

     A     magic square	is	 a	 two-dimensional	array	with	n rows and n columns	in	  which	each	   of	  the	
integers	1,	 2,	 3,	 ...,	n
2
 appears exactly once and	   all	  column	sums,	row	   sums	and	   diagonal	sums	
are	equal.
 The array A is a
 
77×
 magic	square	in	 which	all	rows,	columns	and	   the	  two	   main	    diagonals	add	
up	to	175.
A
[0][1][2][3][4][5][6]
[0]3039481   101928
[1]384779   182729
[2]4668   17263537
[3]5   141625343645
[4]1315243342444
[5]21233241433   12
[6]223140492   1120
(a)	  Construct	an	  algorithm	to	  calculate	the	   sum	   of	  all	  elements	on	  the	   main	diagonal,	 
from	   A[0,	0]	to	A[6,	6].
[2]
(b)  An  array  with  n  rows  and  n columns	holds	every	number	from	1	 to	n
2
.    Construct  an  
algorithm	that	checks	whether	the 
nn×
 array	is	a	magic	square.[8]
The	   following	is	 the	  algorithm	for	  constructing	a	 magic	square	with	n rows and n	 columns	for	
any	odd	integer	n.
•	 Z	=	1
•	 Place	Z	in	the	middle	of	top	row
•	 Loop	until	all	integers	1,	2,	3,	...,	n
2
 are placed in the array
•	 Z	=	Z	+	1
•	 Move	one	   row	   up	  and	   one	   column	to	 the	  right	   to	 place	the	  integer	Z,	  unless	one	   of	 the	
following	occurs
•	 If	   a	 move	takes	you	   above	the	  top	  row	   in	 the	j
th
	column,	move	to	 the	  bottom	of	
the j
th
	column	and	place	the	integer	Z	there
•	 If	   a	 move	takes	you	   outside	to	  the	  right	    of	  the	  square	in	  the	i
th
	row,	   place	the	
integer	Z	in	the	i
th
 row at the left side
•	 If	   a	 move	takes	you	   to	 an	  already	filled	square	or	  if	 you	   move	out	  of	  the	  square	
at	the	upper-right	corner,	place	Z	immediately	below	Z	–	1.	
(c)	  By	applying	this	   algorithm,	copy and	   complete	the	
55×
	magic	square,	which	has	  been	
started below.  Do not	write	solutions	on	this	page.
[5]
1

8814-7011
–	6	–
N14/4/COMSC/HP1/ENG/TZ0/XX